<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Hexo+next搭建博客指南]]></title>
    <url>%2F%E6%95%99%E7%A8%8B%2FHexo-next%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[Hexo+next搭建博客指南我以前用的博客系统是wordpress，虽然搭起来比较方便，但是权限少，个人觉得wordpress博客系统架构有点混乱。听了@Xieldy和@barriery的建议，开始尝试Hexo系统，发现这个博客系统还基于Flask架构来写的, 我在菊厂实习的时候刚好用flask开发过后台，所以对这个架构比较熟悉。现在来分享一下自己建站的经历（踩的坑）。 我云主机的系统是Ubuntu16.04 首先安装nodejs 一开始我使用的apt源安装，但是Ubuntu源中的nodejs时旧版本，用apt源安装会导致hexo命令异常，所以需要在安装后更新nodejs。 123sudo apt-get install nodejssudo apt install nodejs-legacysudo apt install npm 更换成淘宝的镜像，否则非常慢 1sudo npm config set registry https://registry.npm.taobao.org 可以通过 sudo npm config list 查看是否生效 安装更新版本的工具N 1sudo npm install n -g 更新版本 1sudo n stable 可以看到有 installed：版号，说明更新成功 安装hexo 1sudo npm install -g hexo 选一个空目录创建根目录模版 我选择的是/var/www/html/目录下 1sudo hexo init 下载next主题模版 1sudo git clone https://github.com/iissnan/hexo-theme-next.git themes/next 在根目录_config.yml文件中启用next主题 1theme: next PS: 所有配置文件内，每一项配置的冒号后面都要加上空格 设置语言 在根目录_config.yml文件中 1language: zh-Hans 主题选择 在主题配置文件中，查找scheme, 选择你喜欢的主题对其反注释 12345# 主题中的主题# scheme: Musescheme: Mist# scheme: Pisces# scheme: Gemini 背景设置 在主题配置文件中，查找canvas： 1234567891011# Canvas-nestcanvas_nest: false# three_wavesthree_waves: false# canvas_linescanvas_lines: false# canvas_spherecanvas_sphere: false# Only fit scheme Pisces# Canvas-ribboncanvas_ribbon: true 开启相应的背景，只要把对应的false设置为true，记得把其他都改为false 修改内容区域宽度 Next 对内容的宽度的设定如下： 700px，当屏幕宽度 &lt; 1600px 900px，当屏幕宽度 &gt;= 1600px 移动设备下，宽度自适应 在主题目录下的 source/css_variables/custom.styl 文件，新增变量： 1234// 修改成你期望的宽度$content-desktop = 700px// 当视窗超过 1600px 后的宽度$content-desktop-large = 900px 此方法不适用于 Pisces Scheme， Pisces Scheme 编辑themes/next/source/css/_schemes/Picses/_layout.styl文件，更改以下 css 选项定义值 123.header &#123;width: 1150px;&#125;.container .main-inner &#123;width: 1150px;&#125;.content-wrap &#123;width: calc(100% - 260px);&#125; 文章内链接样式美化 在主题目录下，将source/css/_custom/custom.styl文件修改如下： 1234567891011// 文章内链接文本样式.post-body a&#123; color: #0593d3; border-bottom: none; border-bottom: 1px solid #0593d3; &amp;:hover &#123; color: #fc6423; border-bottom: none; border-bottom: 1px solid #fc6423; &#125;&#125; 文章内代码美化 行内代码 在主题目录下，将source/css/_custom/custom.styl文件修改如下： 123456789//行内代码样式code &#123; color: #c7254e; background: #f9f2f4; border: 1px solid #d6d6d6; padding:1px 4px; word-break: break-all; border-radius:4px;&#125; 区块代码 在主题目录下，修改config.yml文件： 12# 样式可选： normal | night | night eighties | night blue | night brighthighlight_theme: night 添加文章结束语 添加模板文件 在主题目录下/layout/_macro中新建 passage-end-tag.swig文件,并添加以下内容： 1234567&lt;div&gt; &#123;% if not is_index %&#125; &lt;div style="text-align:center;color: #ccc;font-size:14px;"&gt; -------------本文结束&lt;i class="fa fa-paw"&gt;&lt;/i&gt;感谢您的阅读------------- &lt;/div&gt; &#123;% endif %&#125;&lt;/div&gt; 导入模板文件 在/layout/_macro/post.swig文件中，找到： 123&#123;#####################&#125;&#123;### END POST BODY ###&#125;&#123;#####################&#125; 在上面代码之前添加： 12345&lt;div&gt; &#123;% if not is_index %&#125; &#123;% include 'passage-end-tag.swig' %&#125; &#123;% endif %&#125;&lt;/div&gt; 配置 在主题配置文件中添加： 123# 文章末尾添加“本文结束”标记passage_end_tag: enabled: true 增强文章底部版权信息 增加文章md文件的头部信息中添加copyright: true时，添加版权声明 增加文章标题、发布时间、更新时间等信息 在目录next/layout/_macro/下找到post-copyright.swig，进行部分修改： 12345678910111213141516171819202122232425262728&#123;% if page.copyright %&#125;&lt;ul class="post-copyright"&gt; &lt;li class="post-copyright-author"&gt; &lt;strong&gt;本文标题:&lt;/strong&gt; &lt;a href="&#123;&#123; url_for(page.path) &#125;&#125;"&gt;&#123;&#123; page.title &#125;&#125;&lt;/a&gt; &lt;/li&gt; &lt;li class="post-copyright-author"&gt; &lt;strong&gt;&#123;&#123; __('post.copyright.author') + __('symbol.colon') &#125;&#125;&lt;/strong&gt; &#123;&#123; config.author &#125;&#125; &lt;/li&gt; &lt;li class="post-copyright-author"&gt; &lt;strong&gt;发布时间:&lt;/strong&gt; &#123;&#123; page.date.format("YYYY年MM月DD日 - HH:MM") &#125;&#125; &lt;/li&gt; &lt;li class="post-copyright-author"&gt; &lt;strong&gt;最后更新:&lt;/strong&gt; &#123;&#123; page.updated.format("YYYY年MM月DD日 - HH:MM") &#125;&#125; &lt;/li&gt; &lt;li class="post-copyright-link"&gt; &lt;strong&gt;&#123;&#123; __('post.copyright.link') + __('symbol.colon') &#125;&#125;&lt;/strong&gt; &lt;a href="&#123;&#123; post.permalink &#125;&#125;" title="&#123;&#123; post.title &#125;&#125;"&gt;&#123;&#123; post.permalink &#125;&#125;&lt;/a&gt; &lt;/li&gt; &lt;li class="post-copyright-license"&gt; &lt;strong&gt;&#123;&#123; __('post.copyright.license_title') + __('symbol.colon') &#125;&#125; &lt;/strong&gt; &#123;&#123; __('post.copyright.license_content', theme.post_copyright.license_url, theme.post_copyright.license) &#125;&#125; &lt;/li&gt;&lt;/ul&gt;&#123;% endif %&#125; 自定义文章的默认头部信息 在根目录的/scaffolds/post.md文件中添加： 12345678910---title: &#123;&#123; title &#125;&#125;date: &#123;&#123; date &#125;&#125;tags: #标签categories: #分类copyright: true #版权声明permalink: 01 #文章链接，有默认值top: 0 #置顶优先级password: #密码保护--- 文章加密访问(其实可以不用) 打开主题目录下layout/_partials/head.swig文件,在meta标签后面插入这样一段代码： 12345678910&lt;script&gt; (function()&#123; if('&#123;&#123; page.password &#125;&#125;')&#123; if (prompt('请输入文章密码') !== '&#123;&#123; page.password &#125;&#125;')&#123; alert('密码错误！'); history.back(); &#125; &#125; &#125;)();&lt;/script&gt; 然后文章头部信息中添加password： password: 你设置的密码 如果password后面为空，则表示不用密码。 博文置顶 安装hexo-generator-index插件 1npm install hexo-generator-index--save 替换代码 把node_modules/hexo-generator-index/lib/generator.js内的代码替换为： 12345678910111213141516171819202122232425262728'use strict';var pagination = require('hexo-pagination');module.exports = function(locals)&#123; var config = this.config; var posts = locals.posts; posts.data = posts.data.sort(function(a, b) &#123; if(a.top &amp;&amp; b.top) &#123; // 两篇文章top都有定义 if(a.top == b.top) return b.date - a.date; // 若top值一样则按照文章日期降序排 else return b.top - a.top; // 否则按照top值降序排 &#125; else if(a.top &amp;&amp; !b.top) &#123; // 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233） return -1; &#125; else if(!a.top &amp;&amp; b.top) &#123; return 1; &#125; else return b.date - a.date; // 都没定义按照文章日期降序排 &#125;); var paginationDir = config.pagination_dir || 'page'; return pagination('', posts, &#123; perPage: config.index_generator.per_page, layout: ['index', 'archive'], format: paginationDir + '/%d/', data: &#123; __index: true &#125; &#125;);&#125;; 设置top值 在文章头部信息中添加top值，数值越大文章越靠前: 123---top: 100--- 增强文章底部标签 修改模板/themes/next/layout/_macro/post.swig，搜索 rel=”tag”&gt;#，将 #换成 1&lt;i class="fa fa-tag"&gt;&lt;/i&gt; 修改打赏 在主题配置文件中找到如下行，并作出相应的修改，然后上传你的微信和支付宝二维码到博客根目录下的source/img文件夹中 12345# 打赏设置reward_comment: 坚持原创技术分享，您的支持将鼓励我继续创作！wechatpay: /assets/img/weixin.jpgalipay: /assets/img/alipay.jpg# bitcoin: /images/bitcoin.png 字体不闪动设置 修改文件next/source/css/_common/components/post/post-reward.styl，然后注释其中的函数wechat:hover和alipay:hover，如下： 123456789101112/* 注释文字闪动函数#wechat:hover p&#123;animation: roll 0.1s infinite linear;-webkit-animation: roll 0.1s infinite linear;-moz-animation: roll 0.1s infinite linear;&#125;#alipay:hover p&#123;animation: roll 0.1s infinite linear;-webkit-animation: roll 0.1s infinite linear;-moz-animation: roll 0.1s infinite linear;&#125;*/ 添加顶部加载条 在主题配置文件_config.yml中，找到pace并修改： 12pace: truepace_theme: pace-theme-minimal 加载条样式有许多，在你找到的位置中可自行更换 主页文章添加阴影效果 打开/themes/next/source/css/_custom/custom.styl,添加： 1234567.post &#123; margin-top: 60px; margin-bottom: 60px; padding: 25px; -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5); -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5); &#125; 给背景添加蜂窝状动画 添加下列代码到你的布局文件中的标签之前（位置/layout/layout.ejs） 1&lt;script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"&gt;&lt;/script&gt; 在引用的同时可以对 Nest 进行相关的配置 color ： 线条颜色, 默认: ‘0,0,0’ ；三个数字分别为(R,G,B)，注意用,分割 opacity : 线条透明度（0~1）, 默认: 0.5 count : 线条的总数量, 默认: 150，（建议修改少点，否者 cpu 占用过高） zIndex : 背景的z-index属性，css属性用于控制所在层的位置, 默认: -1 例如 1&lt;script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"&gt;&lt;/script&gt; 搜索功能 安装 1npm install hexo-generator-searchdb --save 配置 在主题配置文件下，查找local_search: 1234local_search: enable: false trigger: auto top_n_per_article: 1 enable修改为true 在根目录配置文件中，添加以下代码： 12345search: path: search.xml field: post format: html limit: 10000 页脚美化 隐藏网页底部 powered By Hexo 强力驱动 在主题配置文件_config.yml中修改： 1copyright: false 侧边栏添加访问量等信息 获取不蒜子代码 在不蒜子上获取代码： 1&lt;script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"&gt;&lt;/script&gt; 添加js文件 在主题目录下，找到/layout/_layout.swig文件， 在文件的后面，&lt;/body&gt;标签之前，添加上面代码。 安装wordcount 1npm install hexo-wordcount --save 修改布局 在主题目录下，找到/layout/_macro/sidebar.swig文件，查找/nav，在&lt;/nav&gt;标签之前，添加下面代码： 1234567891011121314&lt;br&gt;&lt;br&gt;&lt;div class="site-state-item site-state-posts" style="border-left:none;"&gt; &lt;span class="site-state-item-count" id="busuanzi_value_site_pv"&gt;&lt;/span&gt; &lt;span class="site-state-item-name"&gt;浏览量&lt;/span&gt;&lt;/div&gt;&lt;div class="site-state-item site-state-posts"&gt; &lt;span class="site-state-item-count" id="busuanzi_value_site_uv"&gt;&lt;/span&gt; &lt;span class="site-state-item-name"&gt;访客量&lt;/span&gt;&lt;/div&gt;&lt;div class="site-state-item site-state-posts"&gt; &lt;span class="site-state-item-count"&gt;&#123;&#123;totalcount(site)&#125;&#125;&lt;/span&gt; &lt;span class="site-state-item-name"&gt;总字数&lt;/span&gt;&lt;/div&gt; 文章标签显示设置 在主题配置文件中，查找post_meta： 1234567891011121314# 文章标签显示设置post_meta: item_text: true created_at: true # 发表时间 updated_at: false # 更新时间 categories: true # 分类# 文章字数显示设置（需要wordcount，前面已经下载）post_wordcount: item_text: true wordcount: true # 显示字数 min2read: false # 所需时间 totalcount: false # 总字数 separated_meta: true # 分割符 文章阅读量 注册leancloud统计账号，按照next官方推荐文档 为NexT主题添加文章阅读量统计功能，获取AppID以及AppKey并在主题的_config.yml文件中填写： 1234leancloud_visitors: enable: true app_id: joaeuuc4hsqudUUwx4gIvGF6-gzGzoHsz app_key: E9UJsJpw1omCHuS22PdSpKoh 添加友言评论 在友言评论中注册，并进入管理来获取你的id。修改主题配置文件的友言id： 12# youyan 评论youyan_uid: &quot;2144889&quot; 添加jiathis分享按钮 将你的友言Id添加进去： 123# jiathis 分享按钮jiathis: uid: &apos;2144889&apos; 参考资料以及FAQ ubuntu下搭建LAMP环境 https://blog.csdn.net/lu_embedded/article/details/79604380 ubuntu创建自签名证书 https://www.howtoing.com/how-to-create-a-self-signed-ssl-certificate-for-apache-in-ubuntu-18-04 腾讯云安装let&#39;s encrypt证书 https://www.howtoing.com/how-to-create-a-self-signed-ssl-certificate-for-apache-in-ubuntu-18-04 安装Next主题 http://theme-next.iissnan.com/getting-started.html#install-next-theme Next github源码包 https://github.com/iissnan/hexo-theme-next GitHub+Hexo 搭建个人网站详细教程 https://zhuanlan.zhihu.com/p/26625249 hexo使用手册 https://hexo.io/docs/server 如何更新npm（它要在themes目录下才能运行，不更新在ubuntu16.04环境下hexo命令会出现异常） https://blog.csdn.net/y5492853/article/details/79529410 Hexo-NexT搭建个人博客 https://neveryu.github.io/2016/09/03/hexo-next-one/ hexo中获取图片失败问题 https://www.jianshu.com/p/c2ba9533088a hexo + next主题高级配置 https://www.jianshu.com/p/344cf061598d hexo常用命令 https://segmentfault.com/a/1190000002632530 添加分类与标签 https://www.jianshu.com/p/e17711e44e00 每次在主页上阅读更多的链接总是指向发表时间最早的一篇，解决方法： https://hexo.io/zh-cn/docs/permalinks.html 蜂窝状动画 http://wintersmilesb101.online/2017/03/22/Next-Use-Nest/]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>next</tag>
        <tag>配置</tag>
      </tags>
  </entry>
</search>
